X31vsGCA = lineX31-lineGCA,
X4vsGCA = lineX4-lineGCA,
X49vsGCA = lineX49-lineGCA,
X5vsGCA = lineX5-lineGCA,
X50vsMAnc = lineX50-lineMAA,
X59vsGCA = lineX59-lineGCA,
X6vsGCA = lineX6-lineGCA,
X61vsGCA = lineX61-lineGCA,
X66vsGCA = lineX66-lineGCA,
X69vsGCA = lineX69-lineGCA,
X7vsGCA = lineX7-lineGCA,
X76vsGCA = lineX76-lineGCA,
X77vsGCA = lineX77-lineGCA,
X8vsGCA = lineX8-lineGCA,
X9vsGCA = lineX9-lineGCA,
GCAvsMAA = lineGCA-lineMAA,
levels=colnames(design)
)
contr.matrix
#voom mean-variance trend
v <- voom(x, design,plot=TRUE)
v
#linear models for comparisons
vfit <- lmFit(v, design)
vfit <- contrasts.fit(vfit,contrasts=contr.matrix)
#in my analysis, get rid of the eBayes part and see if it helps increase the number of DE genes
efit <- eBayes(vfit)
plotSA(efit)
#looking at the number of DE genes
summary(decideTests(efit))
et <- decideTests(efit)
#can use log-FC above or below certain value to make the cutoff stricter
#use treat for this
#do not use
#tfit <- treat(vfit,lfc=1)
#dt <- decideTests(tfit)
#summary(dt)
#can find commonly DE genes (this is between line 11 and line 112)
de.common <- which(et[,2]!=0 & et[,3]!=0)
length(de.common)
#7 common DE genes
head(efit$genes$GENENAME[de.common],n=20)
vennDiagram(et[,2:3], circle.col=c("turquoise","salmon"))
write.fit(efit, et, file="results11.112.txt")
#looking at individual DE genes from top to bottom
X112vsMAA <- topTable(efit, coef=3, n=Inf)
#can use TopTable for eBayes stuff
#not sure what to use for non eBayes or Treat stuff
X11vsGCA <- topTable(efit, coef=2, n=Inf)
head(X11vsGCA)
head(X112vsMAA)
##graphical representations of DE results
#plodMD function - highlights the DE genes in a mean-variance plot
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[2],xlim=c(-8,13))
#glimma has one too
#its interactive
glMDPlot(efit,coef=1, status=et, main=colnames(efit)[2], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
#can also create heatmaps
#for certain contrasts
library(gplots)
X11.vs.anc.topgenes <- X11vsGCA$GENENAME[1:50]
i <- which(v$genes$GENENAME %in% X11.vs.anc.topgenes)
mycol <- colorpanel(1000,"blue","white","red")
v$E[i,]
heatmap.2(v$E[i,],scale="row",col=mycol, labRow=v$genes$GENENAME[i],density.info="none",dendrogram="column")
X11.vs.anc.topgenes <- X11vsGCA$GENENAME[1:100]
X11.vs.anc.topgenes <- X11vsGCA$GENEID[1:100]
i <- which(v$genes$GENEID %in% X11.vs.anc.topgenes)
mycol <- colorpanel(1000,"blue","white","red")
v$E[i,]
heatmap.2(v$E[i,],scale="row",col=mycol, labRow=v$genes$GENENAME[i],density.info="none",dendrogram="column")
heatmap.2(v$E[i,],scale="row",col=mycol, labRow=v$genes$GENENAME[i],density.info="none",dendrogram="column")
par("mar")
par("mar")
par(mar=c(1,1,1,1))
idx <- ids2indices(ubp6, X11vsGCA$GENEID,remove.empty=TRUE)
upb6 <- c("YFR010W")
idx <- ids2indices(ubp6, X11vsGCA$GENEID,remove.empty=TRUE)
ubp6 <- c("YFR010W")
idx <- ids2indices(ubp6, X11vsGCA$GENEID,remove.empty=TRUE)
camera(X11vsGCA, ubp6, design)
X117vsMAnc <- topTable(efit, coef=5, n=Inf)
X49vsGCA <- topTable(efit, coef=16, n=Inf)
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[2],xlim=c(-8,13))
X1vsGCA <- topTable(efit, coef=1, n=Inf)
X11vsGCA <- topTable(efit, coef=2, n=Inf)
X112vsMAA <- topTable(efit, coef=3, n=Inf)
X115vsMAnc  <- topTable(efit, coef=4, n=Inf)
X117vsMAnc <- topTable(efit, coef=5, n=Inf)
X123vsMAnc <- topTable(efit, coef=6, n=Inf)
X141vsMAnc <- topTable(efit, coef=7, n=Inf)
X152vsMAnc <- topTable(efit, coef=8, n=Inf)
X18vsGCA <- topTable(efit, coef=9, n=Inf)
X2vsGCA <- topTable(efit, coef=10, n=Inf)
X21vsGCA <- topTable(efit, coef=11, n=Inf)
X29vsMAnc <- topTable(efit, coef=12, n=Inf)
X3vsGCA <- topTable(efit, coef=13, n=Inf)
X31vsGCA <- topTable(efit, coef=14, n=Inf)
X4vsGCA <- topTable(efit, coef=15, n=Inf)
X49vsGCA <- topTable(efit, coef=16, n=Inf)
X5vsGCA <- topTable(efit, coef=17, n=Inf)
X50vsMAnc <- topTable(efit, coef=18, n=Inf)
X59vsGCA <- topTable(efit, coef=19, n=Inf)
X6vsGCA <- topTable(efit, coef=20, n=Inf)
X61vsGCA <- topTable(efit, coef=21, n=Inf)
X66vsGCA <- topTable(efit, coef=22, n=Inf)
X69vsGCA <- topTable(efit, coef=23, n=Inf)
X7vsGCA <- topTable(efit, coef=24, n=Inf)
X76vsGCA <- topTable(efit, coef=25, n=Inf)
X77vsGCA <- topTable(efit, coef=26, n=Inf)
X8vsGCA <- topTable(efit, coef=27, n=Inf)
X9vsGCA <- topTable(efit, coef=28, n=Inf)
GCAvsMAA <- topTable(efit, coef=29, n=Inf)
head(X11vsGCA)
head(X112vsMAA)
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[1],xlim=c(-8,13))
##graphical representations of DE results
#plodMD function - highlights the DE genes in a mean-variance plot
#line 1
{pdf("MD_line1.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[1],xlim=c(-8,13))}
#line 11
{pdf ("MD_line11.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[2],xlim=c(-8,13))}
#line 112
{pdf("MD_line112.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[3],xlim=c(-8,13))}
#line 115
{
pdf("MD_line115.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[4],xlim=c(-8,13))}
#line 117
{pdf("MD_line117.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[5],xlim=c(-8,13))}
#line123
{pdf("MD_line123.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[6],xlim=c(-8,13))}
#line 141
{pdf("MD_line141.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[7],xlim=c(-8,13))}
#line152
{pdf("MD_line152.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[8],xlim=c(-8,13))}
#line18
{pdf("MD_line18.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[9],xlim=c(-8,13))}
#line 2
{pdf("MD_line2.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[10],xlim=c(-8,13))}
#line 21
{pdf("MD_line21.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[11],xlim=c(-8,13))}
# line 29
{pdf("MD_line29.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[12],xlim=c(-8,13))}
# line 3
{pdf("MD_line3.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[13],xlim=c(-8,13))}
# line 31
{pdf("MD_line31.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[14],xlim=c(-8,13))}
#line 4
{pdf("MD_line4.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[15],xlim=c(-8,13))}
#line 49
{pdf("MD_line49.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[16],xlim=c(-8,13))}
#line 5
{pdf("MD_line5.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[17],xlim=c(-8,13))}
#line 50
{pdf("MD_line50.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[18],xlim=c(-8,13))}
#line 59
{pdf("MD_line59.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[19],xlim=c(-8,13))}
#line 6
{pdf("MD_line6.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[20],xlim=c(-8,13))}
#line 61
{pdf("MD_line61.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[21],xlim=c(-8,13))}
#line 66
{pdf("MD_line66.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[22],xlim=c(-8,13))}
#line 69
{pdf("MD_line69.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[23],xlim=c(-8,13))}
#line 7
{pdf("MD_line7.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[24],xlim=c(-8,13))}
#line 76
{pdf("MD_line76.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[25],xlim=c(-8,13))}
#line 77
{pdf("MD_line77.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[26],xlim=c(-8,13))}
#line 8
{pdf("MD_line8.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[27],xlim=c(-8,13))}
#line 9
{pdf("MD_line9.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[28],xlim=c(-8,13))}
#GC vs MA ancestors
{pdf("MD_ancestors.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[29],xlim=c(-8,13))}
{pdf("MD_line1.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[1],xlim=c(-8,13))}
{pdf ("MD_line11.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[2],xlim=c(-8,13))}
{pdf("MD_line112.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[3],xlim=c(-8,13))}
{
pdf("MD_line115.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[4],xlim=c(-8,13))}
{pdf("MD_line117.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[5],xlim=c(-8,13))}
{pdf("MD_line123.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[6],xlim=c(-8,13))}
{pdf("MD_line141.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[7],xlim=c(-8,13))}
{pdf("MD_line152.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[8],xlim=c(-8,13))}
{pdf("MD_line18.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[9],xlim=c(-8,13))}
{pdf("MD_line2.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[10],xlim=c(-8,13))}
{pdf("MD_line21.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[11],xlim=c(-8,13))}
{pdf("MD_line29.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[12],xlim=c(-8,13))}
{pdf("MD_line3.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[13],xlim=c(-8,13))}
{pdf("MD_line31.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[14],xlim=c(-8,13))}
{pdf("MD_line4.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[15],xlim=c(-8,13))}
{pdf("MD_line49.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[16],xlim=c(-8,13))}
{pdf("MD_line5.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[17],xlim=c(-8,13))}
{pdf("MD_line50.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[18],xlim=c(-8,13))}
{pdf("MD_line59.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[19],xlim=c(-8,13))}
{pdf("MD_line6.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[20],xlim=c(-8,13))}
{pdf("MD_line61.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[21],xlim=c(-8,13))}
{pdf("MD_line66.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[22],xlim=c(-8,13))}
{pdf("MD_line69.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[23],xlim=c(-8,13))}
{pdf("MD_line7.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[24],xlim=c(-8,13))}
{pdf("MD_line76.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[25],xlim=c(-8,13))}
{pdf("MD_line77.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[26],xlim=c(-8,13))}
{pdf("MD_line8.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[27],xlim=c(-8,13))}
{pdf("MD_line9.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[28],xlim=c(-8,13))}
{pdf("MD_ancestors.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[29],xlim=c(-8,13))}
glMDPlot(efit,coef=1, status=et, main=colnames(efit)[2], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
{pdf("MD_line1.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[1],xlim=c(-8,13))}
{pdf ("MD_line11.pdf")
plotMD(efit, column=2, status=et[,1],main=colnames(efit)[2],xlim=c(-8,13))}
{pdf("MD_line112.pdf")
plotMD(efit, column=3, status=et[,1],main=colnames(efit)[3],xlim=c(-8,13))}
{
pdf("MD_line115.pdf")
plotMD(efit, column=4, status=et[,1],main=colnames(efit)[4],xlim=c(-8,13))}
{pdf("MD_line117.pdf")
plotMD(efit, column=5, status=et[,1],main=colnames(efit)[5],xlim=c(-8,13))}
{pdf("MD_line123.pdf")
plotMD(efit, column=6, status=et[,1],main=colnames(efit)[6],xlim=c(-8,13))}
{pdf("MD_line141.pdf")
plotMD(efit, column=7, status=et[,1],main=colnames(efit)[7],xlim=c(-8,13))}
{pdf("MD_line152.pdf")
plotMD(efit, column=8, status=et[,1],main=colnames(efit)[8],xlim=c(-8,13))}
{pdf("MD_line18.pdf")
plotMD(efit, column=9, status=et[,1],main=colnames(efit)[9],xlim=c(-8,13))}
{pdf("MD_line2.pdf")
plotMD(efit, column=10, status=et[,1],main=colnames(efit)[10],xlim=c(-8,13))}
{pdf("MD_line21.pdf")
plotMD(efit, column=11, status=et[,1],main=colnames(efit)[11],xlim=c(-8,13))}
{pdf("MD_line29.pdf")
plotMD(efit, column=12, status=et[,1],main=colnames(efit)[12],xlim=c(-8,13))}
{pdf("MD_line3.pdf")
plotMD(efit, column=13, status=et[,1],main=colnames(efit)[13],xlim=c(-8,13))}
{pdf("MD_line31.pdf")
plotMD(efit, column=14, status=et[,1],main=colnames(efit)[14],xlim=c(-8,13))}
{pdf("MD_line4.pdf")
plotMD(efit, column=15, status=et[,1],main=colnames(efit)[15],xlim=c(-8,13))}
{pdf("MD_line49.pdf")
plotMD(efit, column=16, status=et[,1],main=colnames(efit)[16],xlim=c(-8,13))}
{pdf("MD_line5.pdf")
plotMD(efit, column=17, status=et[,1],main=colnames(efit)[17],xlim=c(-8,13))}
{pdf("MD_line50.pdf")
plotMD(efit, column=18, status=et[,1],main=colnames(efit)[18],xlim=c(-8,13))}
{pdf("MD_line59.pdf")
plotMD(efit, column=19, status=et[,1],main=colnames(efit)[19],xlim=c(-8,13))}
{pdf("MD_line6.pdf")
plotMD(efit, column=20, status=et[,1],main=colnames(efit)[20],xlim=c(-8,13))}
{pdf("MD_line61.pdf")
plotMD(efit, column=21, status=et[,1],main=colnames(efit)[21],xlim=c(-8,13))}
{pdf("MD_line66.pdf")
plotMD(efit, column=22, status=et[,1],main=colnames(efit)[22],xlim=c(-8,13))}
{pdf("MD_line69.pdf")
plotMD(efit, column=23, status=et[,1],main=colnames(efit)[23],xlim=c(-8,13))}
{pdf("MD_line7.pdf")
plotMD(efit, column=24, status=et[,1],main=colnames(efit)[24],xlim=c(-8,13))}
{pdf("MD_line76.pdf")
plotMD(efit, column=25, status=et[,1],main=colnames(efit)[25],xlim=c(-8,13))}
{pdf("MD_line77.pdf")
plotMD(efit, column=26, status=et[,1],main=colnames(efit)[26],xlim=c(-8,13))}
{pdf("MD_line8.pdf")
plotMD(efit, column=27, status=et[,1],main=colnames(efit)[27],xlim=c(-8,13))}
{pdf("MD_line9.pdf")
plotMD(efit, column=28, status=et[,1],main=colnames(efit)[28],xlim=c(-8,13))}
{pdf("MD_ancestors.pdf")
plotMD(efit, column=29, status=et[,1],main=colnames(efit)[29],xlim=c(-8,13))}
glMDPlot(efit,coef=1, status=et, main=colnames(efit)[1], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=2, status=et, main=colnames(efit)[2], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=1, status=et, main=colnames(efit)[1], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=2, status=et, main=colnames(efit)[2], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=3, status=et, main=colnames(efit)[3], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=4, status=et, main=colnames(efit)[4], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=5, status=et, main=colnames(efit)[5], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=6, status=et, main=colnames(efit)[6], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=7, status=et, main=colnames(efit)[7], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=8, status=et, main=colnames(efit)[8], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=9, status=et, main=colnames(efit)[9], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=10, status=et, main=colnames(efit)[10], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=11, status=et, main=colnames(efit)[11], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=12, status=et, main=colnames(efit)[12], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=13, status=et, main=colnames(efit)[13], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=14, status=et, main=colnames(efit)[14], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=15, status=et, main=colnames(efit)[15], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=16, status=et, main=colnames(efit)[16], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=17, status=et, main=colnames(efit)[17], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=18, status=et, main=colnames(efit)[18], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=19, status=et, main=colnames(efit)[19], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=20, status=et, main=colnames(efit)[20], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=21, status=et, main=colnames(efit)[21], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=22, status=et, main=colnames(efit)[22], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=23, status=et, main=colnames(efit)[23], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=24, status=et, main=colnames(efit)[24], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=25, status=et, main=colnames(efit)[25], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=26, status=et, main=colnames(efit)[26], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=27, status=et, main=colnames(efit)[27], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=28, status=et, main=colnames(efit)[28], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=29, status=et, main=colnames(efit)[29], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
{pdf("MD_line1.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[1],xlim=c(-8,13))}
{pdf ("MD_line11.pdf")
plotMD(efit, column=2, status=et[,2],main=colnames(efit)[2],xlim=c(-8,13))}
{pdf("MD_line112.pdf")
plotMD(efit, column=3, status=et[,3],main=colnames(efit)[3],xlim=c(-8,13))}
glMDPlot(efit,coef=1, status=et[,1], main=colnames(efit)[1], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=2, status=et[,2], main=colnames(efit)[2], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=29, status=et[,29], main=colnames(efit)[29], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
{pdf("MD_line1.pdf")
plotMD(efit, column=1, status=et[,1],main=colnames(efit)[1],xlim=c(-8,13))}
#line 11
{pdf ("MD_line11.pdf")
plotMD(efit, column=2, status=et[,2],main=colnames(efit)[2],xlim=c(-8,13))}
#line 112
{pdf("MD_line112.pdf")
plotMD(efit, column=3, status=et[,3],main=colnames(efit)[3],xlim=c(-8,13))}
#line 115
{
pdf("MD_line115.pdf")
plotMD(efit, column=4, status=et[,4],main=colnames(efit)[4],xlim=c(-8,13))}
#line 117
{pdf("MD_line117.pdf")
plotMD(efit, column=5, status=et[,5],main=colnames(efit)[5],xlim=c(-8,13))}
#line123
{pdf("MD_line123.pdf")
plotMD(efit, column=6, status=et[,6],main=colnames(efit)[6],xlim=c(-8,13))}
#line 141
{pdf("MD_line141.pdf")
plotMD(efit, column=7, status=et[,7],main=colnames(efit)[7],xlim=c(-8,13))}
#line152
{pdf("MD_line152.pdf")
plotMD(efit, column=8, status=et[,8],main=colnames(efit)[8],xlim=c(-8,13))}
#line18
{pdf("MD_line18.pdf")
plotMD(efit, column=9, status=et[,9],main=colnames(efit)[9],xlim=c(-8,13))}
#line 2
{pdf("MD_line2.pdf")
plotMD(efit, column=10, status=et[,10],main=colnames(efit)[10],xlim=c(-8,13))}
#line 21
{pdf("MD_line21.pdf")
plotMD(efit, column=11, status=et[,11],main=colnames(efit)[11],xlim=c(-8,13))}
# line 29
{pdf("MD_line29.pdf")
plotMD(efit, column=12, status=et[,12],main=colnames(efit)[12],xlim=c(-8,13))}
# line 3
{pdf("MD_line3.pdf")
plotMD(efit, column=13, status=et[,13],main=colnames(efit)[13],xlim=c(-8,13))}
# line 31
{pdf("MD_line31.pdf")
plotMD(efit, column=14, status=et[,14],main=colnames(efit)[14],xlim=c(-8,13))}
#line 4
{pdf("MD_line4.pdf")
plotMD(efit, column=15, status=et[,15],main=colnames(efit)[15],xlim=c(-8,13))}
#line 49
{pdf("MD_line49.pdf")
plotMD(efit, column=16, status=et[,16],main=colnames(efit)[16],xlim=c(-8,13))}
#line 5
{pdf("MD_line5.pdf")
plotMD(efit, column=17, status=et[,17],main=colnames(efit)[17],xlim=c(-8,13))}
#line 50
{pdf("MD_line50.pdf")
plotMD(efit, column=18, status=et[,18],main=colnames(efit)[18],xlim=c(-8,13))}
#line 59
{pdf("MD_line59.pdf")
plotMD(efit, column=19, status=et[,19],main=colnames(efit)[19],xlim=c(-8,13))}
#line 6
{pdf("MD_line6.pdf")
plotMD(efit, column=20, status=et[,20],main=colnames(efit)[20],xlim=c(-8,13))}
#line 61
{pdf("MD_line61.pdf")
plotMD(efit, column=21, status=et[,21],main=colnames(efit)[21],xlim=c(-8,13))}
#line 66
{pdf("MD_line66.pdf")
plotMD(efit, column=22, status=et[,22],main=colnames(efit)[22],xlim=c(-8,13))}
#line 69
{pdf("MD_line69.pdf")
plotMD(efit, column=23, status=et[,23],main=colnames(efit)[23],xlim=c(-8,13))}
#line 7
{pdf("MD_line7.pdf")
plotMD(efit, column=24, status=et[,24],main=colnames(efit)[24],xlim=c(-8,13))}
#line 76
{pdf("MD_line76.pdf")
plotMD(efit, column=25, status=et[,25],main=colnames(efit)[25],xlim=c(-8,13))}
#line 77
{pdf("MD_line77.pdf")
plotMD(efit, column=26, status=et[,26],main=colnames(efit)[26],xlim=c(-8,13))}
#line 8
{pdf("MD_line8.pdf")
plotMD(efit, column=27, status=et[,27],main=colnames(efit)[27],xlim=c(-8,13))}
#line 9
{pdf("MD_line9.pdf")
plotMD(efit, column=28, status=et[,28],main=colnames(efit)[28],xlim=c(-8,13))}
#GC vs MA ancestors
{pdf("MD_ancestors.pdf")
plotMD(efit, column=29, status=et[,29],main=colnames(efit)[29],xlim=c(-8,13))}
#glimma has one too
#its interactive
glMDPlot(efit,coef=1, status=et[,1], main=colnames(efit)[1], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=2, status=et[,2], main=colnames(efit)[2], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=3, status=et[,3], main=colnames(efit)[3], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=4, status=et[,4], main=colnames(efit)[4], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=5, status=et[,5], main=colnames(efit)[5], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=6, status=et[,6], main=colnames(efit)[6], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=7, status=et[,7], main=colnames(efit)[7], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=8, status=et[,8], main=colnames(efit)[8], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=9, status=et[,9], main=colnames(efit)[9], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=10, status=et[,10], main=colnames(efit)[10], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=11, status=et[,11], main=colnames(efit)[11], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=12, status=et[,12], main=colnames(efit)[12], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=13, status=et[,13], main=colnames(efit)[13], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=14, status=et[,14], main=colnames(efit)[14], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=15, status=et[,15], main=colnames(efit)[15], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=16, status=et[,16], main=colnames(efit)[16], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=17, status=et[,17], main=colnames(efit)[17], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=18, status=et[,18], main=colnames(efit)[18], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=19, status=et[,19], main=colnames(efit)[19], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=20, status=et[,20], main=colnames(efit)[20], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=21, status=et[,21], main=colnames(efit)[21], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=22, status=et[,22], main=colnames(efit)[22], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=23, status=et[,23], main=colnames(efit)[23], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=24, status=et[,24], main=colnames(efit)[24], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=25, status=et[,25], main=colnames(efit)[25], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=26, status=et[,26], main=colnames(efit)[26], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=27, status=et[,27], main=colnames(efit)[27], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=28, status=et[,28], main=colnames(efit)[28], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
glMDPlot(efit,coef=29, status=et[,29], main=colnames(efit)[29], id.column="GENENAME", counts=x$counts, groups=group, launch=TRUE)
View(X112vsMAA)
vennDiagram(et[,2:3], circle.col=c("turquoise","salmon"))
topTable(efit, coef=29, n=Inf)
summary(decideTests(efit))
files <- list.files(path="/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Indiv_Genes/HTseq/Holly_Seq/",pattern = "*.txt", full.names = TRUE)
files
library(limma)
library(edgeR)
library(dplyr)
x <- readDGE(files,columns=c(1,2))
class(x)
dim(x)
files
samplenames1 <- c("112B","112C","115B","115C","117B","117C","11B","11C","123B","123C","141B","141C","152B","152C","18B","18C","1B","1C","21B","21C","29B","29C","GC2A","GC2B","GC2C","31B","31C","GC3A","GC3B","GC3C","49B","49C","GC4B","GC4C","50B","59B","59C","GC5A","GC5B","GC5C","61B","61C","66C","69B","69C","GC6A","GC6B","GC6C","76B","76C","GC7B","GC7C","GC8B","GC8C","GC9A","GC9B","GC9C","GC1A","59A","66A","69A","76A","77A","GCAncA","GCAncB","GCAncC","66B","11A","18A","21A","31A","GC4A","49A","61A","GC7A","GC8A","11R","18R","21R","31R","GC4R","49R","61R","GC7R","GC8R","MA_Anc_CR","MA1A","MA1B","MA1C","MA2A","MA2B","MA2C","MA3A","MA3B","MA3C","MA4A","MA4B","MA4C","MA5A","MA5B","MA5C","MA6A","MA6B","MA6C","MA7A","MA7B","MA7C","MA8A","MA8B","MA8C","MA9A","MA9B","MA9C","MA11A","MA11B","MA11C","15A","15B","15C","28A","28B","28C","88A","88B","88C","108A","108B","108C","119A","119B","119C","OMAAncA","OMAAncB","OMAAncC")
colnames(x) <-samplenames1
length(samplenames1)
dim(x)
samplenames1 <- c("112B","112C","115B","115C","117B","117C","11B","11C","123B","123C","141B","141C","152B","152C","18B","18C","1B","1C","21B","21C","29B","29C","GC2A","GC2B","GC2C","31B","31C","GC3A","GC3B","GC3C","49B","49C","GC4B","GC4C","50B","59B","59C","GC5A","GC5B","GC5C","61B","61C","66C","69B","69C","GC6A","GC6B","GC6C","76B","76C","77B","77C","GC7B","GC7C","GC8B","GC8C","GC9A","GC9B","GC9C","GC1A","59A","66A","69A","76A","77A","GCAncA","GCAncB","GCAncC","66B","11A","18A","21A","31A","GC4A","49A","61A","GC7A","GC8A","11R","18R","21R","31R","GC4R","49R","61R","GC7R","GC8R","MA_Anc_CR","MA1A","MA1B","MA1C","MA2A","MA2B","MA2C","MA3A","MA3B","MA3C","MA4A","MA4B","MA4C","MA5A","MA5B","MA5C","MA6A","MA6B","MA6C","MA7A","MA7B","MA7C","MA8A","MA8B","MA8C","MA9A","MA9B","MA9C","MA11A","MA11B","MA11C","15A","15B","15C","28A","28B","28C","88A","88B","88C","108A","108B","108C","119A","119B","119C","OMAAncA","OMAAncB","OMAAncC")
length(samplenames1)
colnames(x) <-samplenames1
x
length(line)
line <- c("M112","M112","M115","M115","M117","M117","G11","G11","M123","M123","M141","M141","M152","M152","G18","G18","G1","G1","G21","G21","M29","M29","G2","G2","G2","G31","G31","G3","G3","G3","G49","G49","G4","G4","M50","G59","G59","G5","G5","G5","G61","G61","G66","G69","G69","G6","G6","G6","G76","G76","G77","G77","G7","G7","G8","G8","G8","G9","G9","G9","G1","G59","G66","G69","G76","G77","GA","GA","GA","G66","G11","G18","G21","G31","G4","G49","G61","G7","G8","G11","G18","G21","G31","G4","G49","G61","G7","G8","MAA","M1","M1","M1","M2","M2","M2","M3","M3","M3","M4","M4","M4","M5","M5","M5","M6","M6","M6","M7","M7","M7","M8","M8","M8","M9","M9","M9","M11","M11","M11","M15","M15","M15","M28","M28","M28","M88","M88","M88","M108","M108","M108","M119","M119","M119","MAO","MAO","MAO")
length(line)
files <- list.files(path="/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Indiv_Genes/HTseq/Holly_Seq/",pattern = "*.txt", full.names = TRUE)
files
x <- readDGE(files,columns=c(1,2))
class(x)
dim(x)
