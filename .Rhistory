boxplot( (log2(euRatio.c14)),(log2(l076.14[,3])),names=c("Disomic", "Trisomic"),ylab="log2(fold change)", col=c("aquamarine3", "deeppink1"),main="Chr 14 Gene Expression: Line 76",las=3)
t.test((log2(l076.14[,3])), (log2(euRatio.c14)), paired=FALSE, var.equal=TRUE)
abline(h=0,lty=3)
p5 <-"< 2.2e-16"
mylabel = bquote(italic(p) == .(format(p5, digits = 9)))
text(x=2.3,y = 2.5, labels = mylabel,cex=.8)
l011.15 <- getChrmRatio("11",15)
anRatio.c15 <- c(l011.15[,3])
euRatio.c15 <- c(l002.15[,3],l003.15[,3],l005.15[,3],l006.15[,3],l009.15[,3])
boxplot( (log2(euRatio.c15)),(log2(l011.15[,3])),names=c("Disomic", "Trisomic"),ylab="log2(fold change)", col=c("aquamarine1", "violetred1"),main="Chr 15 Gene Expression: Line 11",las=3)
t.test((log2(l011.15[,3])), (log2(euRatio.c15)), paired=FALSE, var.equal=TRUE)
abline(h=0,lty=3)
p5 <-"< 2.2e-16"
mylabel = bquote(italic(p) == .(format(p5, digits = 9)))
text(x=2.3,y = 2.5, labels = mylabel,cex=.8)
l008.16 <- getChrmRatio("8",16)
l031.16 <- getChrmRatio("31",16)
l069.16 <- getChrmRatio("69",16)
l112.16 <- getChrmRatio("112",16)
l141.16 <- getChrmRatio("141",16)
anRatio.c16 <- c(l008.16[,3],l031.16[,3],l069.16[,3],l112.16[,3],l141.16[,3])
euRatio.c16 <- c(l002.16[,3],l003.16[,3],l005.16[,3],l006.16[,3],l009.16[,3])
boxplot( (log2(euRatio.c16)),(log2(l008.16[,3])),names=c("Disomic", "Trisomic"),ylab="log2(fold change)", col=c("cyan3", "mediumorchid3"),main="Chr 16 Gene Expression: Line 8",las=3)
t.test((log2(l008.16[,3])), (log2(euRatio.c16)), paired=FALSE, var.equal=TRUE)
abline(h=0,lty=3)
p5 <-"< 2.2e-16"
mylabel = bquote(italic(p) == .(format(p5, digits = 9)))
text(x=2.3,y = 2.5, labels = mylabel,cex=.8)
boxplot( (log2(euRatio.c16)),(log2(l031.16[,3])),names=c("Disomic", "Trisomic"),ylab="log2(fold change)", col=c("cyan3", "mediumorchid3"),main="Chr 16 Gene Expression: Line 31",las=3)
t.test((log2(l031.16[,3])), (log2(euRatio.c16)), paired=FALSE, var.equal=TRUE)
abline(h=0,lty=3)
p5 <-0.212
mylabel = bquote(italic(p) == .(format(p5, digits = 9)))
text(x=2.3,y = 2.5, labels = mylabel,cex=.8)
boxplot( (log2(euRatio.c16)),(log2(l069.16[,3])),names=c("Disomic", "Trisomic"),ylab="log2(fold change)", col=c("cyan3", "mediumorchid3"),main="Chr 16 Gene Expression: Line 69",las=3)
t.test((log2(l069.16[,3])), (log2(euRatio.c16)), paired=FALSE, var.equal=TRUE)
abline(h=0,lty=3)
p5 <-0.1216
mylabel = bquote(italic(p) == .(format(p5, digits = 9)))
text(x=2.3,y = 2.5, labels = mylabel,cex=.8)
boxplot( (log2(euRatio.c16)),(log2(l112.16[,3])),names=c("Disomic", "Trisomic"),ylab="log2(fold change)", col=c("cyan3", "mediumorchid3"),main="Chr 16 Gene Expression: Line 112",las=3)
t.test((log2(l112.16[,3])), (log2(euRatio.c16)), paired=FALSE, var.equal=TRUE)
abline(h=0,lty=3)
p5 <-"< 2.2e-16"
mylabel = bquote(italic(p) == .(format(p5, digits = 9)))
text(x=2.3,y = 2.5, labels = mylabel,cex=.8)
boxplot( (log2(euRatio.c16)),(log2(l141.16[,3])),names=c("Disomic", "Trisomic"),ylab="log2(fold change)", col=c("cyan3", "mediumorchid3"),main="Chr 16 Gene Expression: Line 141",las=3)
t.test((log2(l141.16[,3])), (log2(euRatio.c16)), paired=FALSE, var.equal=TRUE)
abline(h=0,lty=3)
p5 <-"< 2.2e-16"
mylabel = bquote(italic(p) == .(format(p5, digits = 9)))
text(x=2.3,y = 2.5, labels = mylabel,cex=.8)
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.20.17.R')
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.22.17.R')
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.csv",header=T)
library(moments)
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.csv",header=T)
View(sc_counts)
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.csv",header=T)
View(sc_counts)
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.csv",header=T)
View(sc_counts)
class(sc_counts)
colnames(sc_counts)[1] <- "gene"; colnames(sc_counts)[2] <- "class_code";colnames(sc_counts)[3] <- "nearest_ref_id"
colnames(sc_counts)[4] <- "ref_id"; colnames(sc_counts)[5] <- "gene_short_name"; colnames(sc_counts)[6] <- "tss_id";
colnames(sc_counts)[7] <- "locus";colnames(sc_counts)[8] <- "length";
View(sc_counts)
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.csv",header=F)
View(sc_counts)
class(sc_counts)
colnames(sc_counts)[1] <- "gene"; colnames(sc_counts)[2] <- "class_code";colnames(sc_counts)[3] <- "nearest_ref_id"
colnames(sc_counts)[4] <- "ref_id"; colnames(sc_counts)[5] <- "gene_short_name"; colnames(sc_counts)[6] <- "tss_id";
colnames(sc_counts)[7] <- "locus";colnames(sc_counts)[8] <- "length";
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.22.17.R')
colnames(sc_counts)[1] <- "gene"; colnames(sc_counts)[2] <- "class_code";colnames(sc_counts)[3] <- "nearest_ref_id"
colnames(sc_counts)[4] <- "ref_id"; colnames(sc_counts)[5] <- "gene_short_name"; colnames(sc_counts)[6] <- "tss_id";
colnames(sc_counts)[7] <- "locus";colnames(sc_counts)[8] <- "length";colnames(sc_counts)[9] <- "null";colnames(sc_counts)[10] <- "X112_0";
colnames(sc_counts)[11] <- "X112_1";colnames(sc_counts)[12] <- "X112_2";colnames(sc_counts)[13] <- "X115_0";
colnames(sc_counts)[14] <- "X115_1";colnames(sc_counts)[15] <- "X115_2";colnames(sc_counts)[16] <- "X117_0";
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.22.17.R')
colnames(sc_counts)[26] <- "X141_1";colnames(sc_counts)[27] <- "X141_2";colnames(sc_counts)[28] <- "X152_1";
colnames(sc_counts)[23] <- "X123_1";colnames(sc_counts)[24] <- "X123_2";colnames(sc_counts)[25] <- "X141_0";
colnames(sc_counts)[26] <- "X141_1";colnames(sc_counts)[27] <- "X141_2";colnames(sc_counts)[28] <- "X152_1";
colnames(sc_counts)[29] <- "X152_0";colnames(sc_counts)[30] <- "X152_2";colnames(sc_counts)[31] <- "X18_1";
colnames(sc_counts)[32] <- "X18_0";colnames(sc_counts)[33] <- "X18_2";colnames(sc_counts)[34] <- "X1_0";
colnames(sc_counts)[35] <- "X1_1";colnames(sc_counts)[35] <- "X1_2";colnames(sc_counts)[36] <- "X21_1";
colnames(sc_counts)[35] <- "X1_1";colnames(sc_counts)[36] <- "X1_2";colnames(sc_counts)[37] <- "X21_1";
colnames(sc_counts)[38] <- "X21_0";colnames(sc_counts)[39] <- "X21_2";colnames(sc_counts)[40] <- "X29_1";
colnames(sc_counts)[41] <- "X29_0";colnames(sc_counts)[42] <- "X29_2";colnames(sc_counts)[43] <- "class_code";
colnames(sc_counts)[41] <- "X29_0";colnames(sc_counts)[42] <- "X29_2";colnames(sc_counts)[43] <- "X2_0";
colnames(sc_counts)[44] <- "X2_1";colnames(sc_counts)[45] <- "X2_2";colnames(sc_counts)[46] <- "X31_1";
colnames(sc_counts)[47] <- "X31_0";colnames(sc_counts)[48] <- "X31_2";colnames(sc_counts)[49] <- "X3_0";
colnames(sc_counts)[50] <- "X3_1";colnames(sc_counts)[51] <- "X3_2";colnames(sc_counts)[52] <- "X49_0";
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.22.17.R')
colnames(sc_counts)[50] <- "X3_1";colnames(sc_counts)[51] <- "X3_2";colnames(sc_counts)[52] <- "X49_0";
colnames(sc_counts)[53] <- "X49_1";colnames(sc_counts)[54] <- "X49_2";colnames(sc_counts)[55] <- "X4_1";
colnames(sc_counts)[56] <- "X4_0";colnames(sc_counts)[57] <- "X4_2";colnames(sc_counts)[58] <- "X50_1";
colnames(sc_counts)[59] <- "X50_0";colnames(sc_counts)[60] <- "X50_2";colnames(sc_counts)[61] <- "X59_0";
colnames(sc_counts)[62] <- "X59_1";colnames(sc_counts)[63] <- "X59_2";colnames(sc_counts)[64] <- "X5_1";
colnames(sc_counts)[65] <- "X5_0";colnames(sc_counts)[66] <- "X5_2";colnames(sc_counts)[67] <- "X61_1";
colnames(sc_counts)[68] <- "X61_0";colnames(sc_counts)[69] <- "X61_2";colnames(sc_counts)[70] <- "X66_0";
colnames(sc_counts)[71] <- "X66_1";colnames(sc_counts)[72] <- "X66_2";colnames(sc_counts)[73] <- "X69_1";
colnames(sc_counts)[74] <- "X69_0";colnames(sc_counts)[75] <- "X69_2";colnames(sc_counts)[76] <- "X6_0";
colnames(sc_counts)[77] <- "X6_1";colnames(sc_counts)[78] <- "X6_2";colnames(sc_counts)[79] <- "X76_0";
colnames(sc_counts)[80] <- "X76_1";colnames(sc_counts)[81] <- "X76_2";colnames(sc_counts)[82] <- "X77_1";
colnames(sc_counts)[83] <- "X77_0";colnames(sc_counts)[84] <- "X77_2";colnames(sc_counts)[85] <- "X7_1";
colnames(sc_counts)[86] <- "X7_0";colnames(sc_counts)[87] <- "X7_2";colnames(sc_counts)[88] <- "X8_0";
colnames(sc_counts)[89] <- "X8_1";colnames(sc_counts)[90] <- "X8_2";colnames(sc_counts)[91] <- "X9_0";
colnames(sc_counts)[92] <- "X9_1";colnames(sc_counts)[93] <- "X9_2";colnames(sc_counts)[94] <- "GC_Anc_1";
colnames(sc_counts)[95] <- "GC_Anc_0";colnames(sc_counts)[96] <- "GC_Anc_2";colnames(sc_counts)[97] <- "MA_Anc_1";
colnames(sc_counts)[98] <- "MA_Anc_0";colnames(sc_counts)[99] <- "MA_Anc_2";
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.22.17.R')
sc_counts <- sc_counts[-c(1), ]
View(sc_counts)
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,9) ]
View(sc_counts.a)
sc_counts.b <- sc_counts[,-c(3) ]
View(sc_counts.b)
sc_counts.b <- sc_counts.a[,-c(3) ]
View(sc_counts.b)
sc_counts.z <- sc_counts.b
sc_counts.z[,3:92] <- sc_counts.z[,3:92]+.5 #add .5 to dataset so the zeroes dont mess up
warnings()
View(sc_counts.z)
sc_counts <- sc_counts[-c(545,1865,2403), ]
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,9) ]
sc_counts.b <- sc_counts.a[,-c(3) ]
sc_counts.z <- sc_counts.b
sc_counts.z[,3:92] <- sc_counts.z[,3:92]+.5 #add .5 to dataset so the zeroes dont mess up
warnings()
View(sc_counts.z)
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.22.17.R')
library(moments)
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.csv",header=F)
View(sc_counts)
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.csv",header=F)
View(sc_counts)
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.22.17.R')
library(moments)
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.split.renamchr.csv",header=F)
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.25.17.R')
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.split.renamchr.csv",header=F)
class(sc_counts)
colnames(sc_counts)[1] <- "gene"; colnames(sc_counts)[2] <- "class_code";colnames(sc_counts)[3] <- "nearest_ref_id"
colnames(sc_counts)[4] <- "ref_id"; colnames(sc_counts)[5] <- "gene_short_name"; colnames(sc_counts)[6] <- "tss_id";
colnames(sc_counts)[7] <- "locus";colnames(sc_counts)[8] <- "length";colnames(sc_counts)[9] <- "null";colnames(sc_counts)[10] <- "X112_0";
colnames(sc_counts)[11] <- "X112_1";colnames(sc_counts)[12] <- "X112_2";colnames(sc_counts)[13] <- "X115_0";
colnames(sc_counts)[14] <- "X115_1";colnames(sc_counts)[15] <- "X115_2";colnames(sc_counts)[16] <- "X117_0";
colnames(sc_counts)[17] <- "X117_1";colnames(sc_counts)[18] <- "X117_2";colnames(sc_counts)[19] <- "X11_1";
colnames(sc_counts)[20] <- "X11_0";colnames(sc_counts)[21] <- "X11_2";colnames(sc_counts)[22] <- "X123_0";
colnames(sc_counts)[23] <- "X123_1";colnames(sc_counts)[24] <- "X123_2";colnames(sc_counts)[25] <- "X141_0";
colnames(sc_counts)[26] <- "X141_1";colnames(sc_counts)[27] <- "X141_2";colnames(sc_counts)[28] <- "X152_1";
colnames(sc_counts)[29] <- "X152_0";colnames(sc_counts)[30] <- "X152_2";colnames(sc_counts)[31] <- "X18_1";
colnames(sc_counts)[32] <- "X18_0";colnames(sc_counts)[33] <- "X18_2";colnames(sc_counts)[34] <- "X1_0";
colnames(sc_counts)[35] <- "X1_1";colnames(sc_counts)[36] <- "X1_2";colnames(sc_counts)[37] <- "X21_1";
colnames(sc_counts)[38] <- "X21_0";colnames(sc_counts)[39] <- "X21_2";colnames(sc_counts)[40] <- "X29_1";
colnames(sc_counts)[41] <- "X29_0";colnames(sc_counts)[42] <- "X29_2";colnames(sc_counts)[43] <- "X2_0";
colnames(sc_counts)[44] <- "X2_1";colnames(sc_counts)[45] <- "X2_2";colnames(sc_counts)[46] <- "X31_1";
colnames(sc_counts)[47] <- "X31_0";colnames(sc_counts)[48] <- "X31_2";colnames(sc_counts)[49] <- "X3_0";
colnames(sc_counts)[50] <- "X3_1";colnames(sc_counts)[51] <- "X3_2";colnames(sc_counts)[52] <- "X49_0";
colnames(sc_counts)[53] <- "X49_1";colnames(sc_counts)[54] <- "X49_2";colnames(sc_counts)[55] <- "X4_1";
colnames(sc_counts)[56] <- "X4_0";colnames(sc_counts)[57] <- "X4_2";colnames(sc_counts)[58] <- "X50_1";
colnames(sc_counts)[59] <- "X50_0";colnames(sc_counts)[60] <- "X50_2";colnames(sc_counts)[61] <- "X59_0";
colnames(sc_counts)[62] <- "X59_1";colnames(sc_counts)[63] <- "X59_2";colnames(sc_counts)[64] <- "X5_1";
colnames(sc_counts)[65] <- "X5_0";colnames(sc_counts)[66] <- "X5_2";colnames(sc_counts)[67] <- "X61_1";
colnames(sc_counts)[68] <- "X61_0";colnames(sc_counts)[69] <- "X61_2";colnames(sc_counts)[70] <- "X66_0";
colnames(sc_counts)[71] <- "X66_1";colnames(sc_counts)[72] <- "X66_2";colnames(sc_counts)[73] <- "X69_1";
colnames(sc_counts)[74] <- "X69_0";colnames(sc_counts)[75] <- "X69_2";colnames(sc_counts)[76] <- "X6_0";
colnames(sc_counts)[77] <- "X6_1";colnames(sc_counts)[78] <- "X6_2";colnames(sc_counts)[79] <- "X76_0";
colnames(sc_counts)[80] <- "X76_1";colnames(sc_counts)[81] <- "X76_2";colnames(sc_counts)[82] <- "X77_1";
colnames(sc_counts)[83] <- "X77_0";colnames(sc_counts)[84] <- "X77_2";colnames(sc_counts)[85] <- "X7_1";
colnames(sc_counts)[86] <- "X7_0";colnames(sc_counts)[87] <- "X7_2";colnames(sc_counts)[88] <- "X8_0";
colnames(sc_counts)[89] <- "X8_1";colnames(sc_counts)[90] <- "X8_2";colnames(sc_counts)[91] <- "X9_0";
colnames(sc_counts)[92] <- "X9_1";colnames(sc_counts)[93] <- "X9_2";colnames(sc_counts)[94] <- "GC_Anc_1";
colnames(sc_counts)[95] <- "GC_Anc_0";colnames(sc_counts)[96] <- "GC_Anc_2";colnames(sc_counts)[97] <- "MA_Anc_1";
colnames(sc_counts)[98] <- "MA_Anc_0";colnames(sc_counts)[99] <- "MA_Anc_2";
sc_counts <- sc_counts[-c(1), ]
sc_counts.a <- sc_counts.rm[,-c(1,2,3,4,6,9) ]
View(sc_counts.a)
sc_counts.z <- sc_counts.a
sc_counts.z[,4:99] <- sc_counts.z[,4:99]+.5 #add .5 to dataset so the zeroes dont mess up
sc_counts.z[,4:93] <- sc_counts.z[,4:93]+.5 #add .5 to dataset so the zeroes dont mess up
warnings()
View(sc_counts.z)
sc_counts.z <- sc_counts.a
sc_counts.z[,4:93] <- sc_counts.z[,4:93]+.5 #add .5 to dataset so the zeroes dont mess up
View(sc_counts)
View(sc_counts.a)
new$X112_0 <-as.numeric(as.character(new[,2])) * 5
sc_counts.z$X112_0 <-as.numeric(as.character(sc_counts.z[,2])) * 5
sc_counts.z <- sc_counts.a
sc_counts.z$X112_0 <-as.numeric(as.character(sc_counts.z[,2]))
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.split.renamchr.rmvmito.csv",header=F)
source('~/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/Holly_DC_workflow_8.25.17.R')
setwd("~/Documents/GitHub/Dosage_Compensation")
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.split.renamchr.rmvmito.csv",header=F)
View(sc_counts)
class(sc_counts)
colnames(sc_counts)[1] <- "gene"; colnames(sc_counts)[2] <- "class_code";colnames(sc_counts)[3] <- "nearest_ref_id"
colnames(sc_counts)[4] <- "ref_id"; colnames(sc_counts)[5] <- "gene_short_name"; colnames(sc_counts)[6] <- "tss_id";
colnames(sc_counts)[7] <- "locus";colnames(sc_counts)[8] <- "length";colnames(sc_counts)[9] <- "null";colnames(sc_counts)[10] <- "X112_0";
colnames(sc_counts)[11] <- "X112_1";colnames(sc_counts)[12] <- "X112_2";colnames(sc_counts)[13] <- "X115_0";
colnames(sc_counts)[14] <- "X115_1";colnames(sc_counts)[15] <- "X115_2";colnames(sc_counts)[16] <- "X117_0";
colnames(sc_counts)[17] <- "X117_1";colnames(sc_counts)[18] <- "X117_2";colnames(sc_counts)[19] <- "X11_1";
colnames(sc_counts)[20] <- "X11_0";colnames(sc_counts)[21] <- "X11_2";colnames(sc_counts)[22] <- "X123_0";
colnames(sc_counts)[23] <- "X123_1";colnames(sc_counts)[24] <- "X123_2";colnames(sc_counts)[25] <- "X141_0";
colnames(sc_counts)[26] <- "X141_1";colnames(sc_counts)[27] <- "X141_2";colnames(sc_counts)[28] <- "X152_1";
colnames(sc_counts)[29] <- "X152_0";colnames(sc_counts)[30] <- "X152_2";colnames(sc_counts)[31] <- "X18_1";
colnames(sc_counts)[32] <- "X18_0";colnames(sc_counts)[33] <- "X18_2";colnames(sc_counts)[34] <- "X1_0";
colnames(sc_counts)[35] <- "X1_1";colnames(sc_counts)[36] <- "X1_2";colnames(sc_counts)[37] <- "X21_1";
colnames(sc_counts)[38] <- "X21_0";colnames(sc_counts)[39] <- "X21_2";colnames(sc_counts)[40] <- "X29_1";
colnames(sc_counts)[41] <- "X29_0";colnames(sc_counts)[42] <- "X29_2";colnames(sc_counts)[43] <- "X2_0";
colnames(sc_counts)[44] <- "X2_1";colnames(sc_counts)[45] <- "X2_2";colnames(sc_counts)[46] <- "X31_1";
colnames(sc_counts)[47] <- "X31_0";colnames(sc_counts)[48] <- "X31_2";colnames(sc_counts)[49] <- "X3_0";
colnames(sc_counts)[50] <- "X3_1";colnames(sc_counts)[51] <- "X3_2";colnames(sc_counts)[52] <- "X49_0";
colnames(sc_counts)[53] <- "X49_1";colnames(sc_counts)[54] <- "X49_2";colnames(sc_counts)[55] <- "X4_1";
colnames(sc_counts)[56] <- "X4_0";colnames(sc_counts)[57] <- "X4_2";colnames(sc_counts)[58] <- "X50_1";
colnames(sc_counts)[59] <- "X50_0";colnames(sc_counts)[60] <- "X50_2";colnames(sc_counts)[61] <- "X59_0";
colnames(sc_counts)[62] <- "X59_1";colnames(sc_counts)[63] <- "X59_2";colnames(sc_counts)[64] <- "X5_1";
colnames(sc_counts)[65] <- "X5_0";colnames(sc_counts)[66] <- "X5_2";colnames(sc_counts)[67] <- "X61_1";
colnames(sc_counts)[68] <- "X61_0";colnames(sc_counts)[69] <- "X61_2";colnames(sc_counts)[70] <- "X66_0";
colnames(sc_counts)[71] <- "X66_1";colnames(sc_counts)[72] <- "X66_2";colnames(sc_counts)[73] <- "X69_1";
colnames(sc_counts)[74] <- "X69_0";colnames(sc_counts)[75] <- "X69_2";colnames(sc_counts)[76] <- "X6_0";
colnames(sc_counts)[77] <- "X6_1";colnames(sc_counts)[78] <- "X6_2";colnames(sc_counts)[79] <- "X76_0";
colnames(sc_counts)[80] <- "X76_1";colnames(sc_counts)[81] <- "X76_2";colnames(sc_counts)[82] <- "X77_1";
colnames(sc_counts)[83] <- "X77_0";colnames(sc_counts)[84] <- "X77_2";colnames(sc_counts)[85] <- "X7_1";
colnames(sc_counts)[86] <- "X7_0";colnames(sc_counts)[87] <- "X7_2";colnames(sc_counts)[88] <- "X8_0";
colnames(sc_counts)[89] <- "X8_1";colnames(sc_counts)[90] <- "X8_2";colnames(sc_counts)[91] <- "X9_0";
colnames(sc_counts)[92] <- "X9_1";colnames(sc_counts)[93] <- "X9_2";colnames(sc_counts)[94] <- "GC_Anc_1";
colnames(sc_counts)[95] <- "GC_Anc_0";colnames(sc_counts)[96] <- "GC_Anc_2";colnames(sc_counts)[97] <- "MA_Anc_1";
colnames(sc_counts)[98] <- "MA_Anc_0";colnames(sc_counts)[99] <- "MA_Anc_2";
sc_counts <- sc_counts[-c(1), ]
sc_counts.a <- sc_counts.rm[,-c(1,2,3,4,6,9) ]
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,9) ]
View(sc_counts.a)
sc_counts.z <- sc_counts.a
sc_counts.z[,4:93] <- sc_counts.z[,4:93]+.5 #add .5 to dataset so the zeroes dont mess up
sc_counts.y[,10:99] <- sc_counts.y[,10:99]+.5 #add .5 to dataset so the zeroes dont mess up
sc_counts.y <- sc_counts
sc_counts.y[,10:99] <- sc_counts.y[,10:99]+.5 #add .5 to dataset so the zeroes dont mess up
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.split.renamchr.rmvmito.csv",header=T)
class(sc_counts)
colnames(sc_counts)[1] <- "gene"; colnames(sc_counts)[2] <- "class_code";colnames(sc_counts)[3] <- "nearest_ref_id"
colnames(sc_counts)[4] <- "ref_id"; colnames(sc_counts)[5] <- "gene_short_name"; colnames(sc_counts)[6] <- "tss_id";
colnames(sc_counts)[7] <- "locus";colnames(sc_counts)[8] <- "length";colnames(sc_counts)[9] <- "null";colnames(sc_counts)[10] <- "X112_0";
colnames(sc_counts)[11] <- "X112_1";colnames(sc_counts)[12] <- "X112_2";colnames(sc_counts)[13] <- "X115_0";
colnames(sc_counts)[14] <- "X115_1";colnames(sc_counts)[15] <- "X115_2";colnames(sc_counts)[16] <- "X117_0";
colnames(sc_counts)[17] <- "X117_1";colnames(sc_counts)[18] <- "X117_2";colnames(sc_counts)[19] <- "X11_1";
colnames(sc_counts)[20] <- "X11_0";colnames(sc_counts)[21] <- "X11_2";colnames(sc_counts)[22] <- "X123_0";
colnames(sc_counts)[23] <- "X123_1";colnames(sc_counts)[24] <- "X123_2";colnames(sc_counts)[25] <- "X141_0";
colnames(sc_counts)[26] <- "X141_1";colnames(sc_counts)[27] <- "X141_2";colnames(sc_counts)[28] <- "X152_1";
colnames(sc_counts)[29] <- "X152_0";colnames(sc_counts)[30] <- "X152_2";colnames(sc_counts)[31] <- "X18_1";
colnames(sc_counts)[32] <- "X18_0";colnames(sc_counts)[33] <- "X18_2";colnames(sc_counts)[34] <- "X1_0";
colnames(sc_counts)[35] <- "X1_1";colnames(sc_counts)[36] <- "X1_2";colnames(sc_counts)[37] <- "X21_1";
colnames(sc_counts)[38] <- "X21_0";colnames(sc_counts)[39] <- "X21_2";colnames(sc_counts)[40] <- "X29_1";
colnames(sc_counts)[41] <- "X29_0";colnames(sc_counts)[42] <- "X29_2";colnames(sc_counts)[43] <- "X2_0";
colnames(sc_counts)[44] <- "X2_1";colnames(sc_counts)[45] <- "X2_2";colnames(sc_counts)[46] <- "X31_1";
colnames(sc_counts)[47] <- "X31_0";colnames(sc_counts)[48] <- "X31_2";colnames(sc_counts)[49] <- "X3_0";
colnames(sc_counts)[50] <- "X3_1";colnames(sc_counts)[51] <- "X3_2";colnames(sc_counts)[52] <- "X49_0";
colnames(sc_counts)[53] <- "X49_1";colnames(sc_counts)[54] <- "X49_2";colnames(sc_counts)[55] <- "X4_1";
colnames(sc_counts)[56] <- "X4_0";colnames(sc_counts)[57] <- "X4_2";colnames(sc_counts)[58] <- "X50_1";
colnames(sc_counts)[59] <- "X50_0";colnames(sc_counts)[60] <- "X50_2";colnames(sc_counts)[61] <- "X59_0";
colnames(sc_counts)[62] <- "X59_1";colnames(sc_counts)[63] <- "X59_2";colnames(sc_counts)[64] <- "X5_1";
colnames(sc_counts)[65] <- "X5_0";colnames(sc_counts)[66] <- "X5_2";colnames(sc_counts)[67] <- "X61_1";
colnames(sc_counts)[68] <- "X61_0";colnames(sc_counts)[69] <- "X61_2";colnames(sc_counts)[70] <- "X66_0";
colnames(sc_counts)[71] <- "X66_1";colnames(sc_counts)[72] <- "X66_2";colnames(sc_counts)[73] <- "X69_1";
colnames(sc_counts)[74] <- "X69_0";colnames(sc_counts)[75] <- "X69_2";colnames(sc_counts)[76] <- "X6_0";
colnames(sc_counts)[77] <- "X6_1";colnames(sc_counts)[78] <- "X6_2";colnames(sc_counts)[79] <- "X76_0";
colnames(sc_counts)[80] <- "X76_1";colnames(sc_counts)[81] <- "X76_2";colnames(sc_counts)[82] <- "X77_1";
colnames(sc_counts)[83] <- "X77_0";colnames(sc_counts)[84] <- "X77_2";colnames(sc_counts)[85] <- "X7_1";
colnames(sc_counts)[86] <- "X7_0";colnames(sc_counts)[87] <- "X7_2";colnames(sc_counts)[88] <- "X8_0";
colnames(sc_counts)[89] <- "X8_1";colnames(sc_counts)[90] <- "X8_2";colnames(sc_counts)[91] <- "X9_0";
colnames(sc_counts)[92] <- "X9_1";colnames(sc_counts)[93] <- "X9_2";colnames(sc_counts)[94] <- "GC_Anc_1";
colnames(sc_counts)[95] <- "GC_Anc_0";colnames(sc_counts)[96] <- "GC_Anc_2";colnames(sc_counts)[97] <- "MA_Anc_1";
colnames(sc_counts)[98] <- "MA_Anc_0";colnames(sc_counts)[99] <- "MA_Anc_2";
View(sc_counts)
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.split.renamchr.rmvmito.csv",header=F)
class(sc_counts)
colnames(sc_counts)[1] <- "gene"; colnames(sc_counts)[2] <- "class_code";colnames(sc_counts)[3] <- "nearest_ref_id"
colnames(sc_counts)[4] <- "ref_id"; colnames(sc_counts)[5] <- "gene_short_name"; colnames(sc_counts)[6] <- "tss_id";
colnames(sc_counts)[7] <- "locus";colnames(sc_counts)[8] <- "length";colnames(sc_counts)[9] <- "null";colnames(sc_counts)[10] <- "X112_0";
colnames(sc_counts)[11] <- "X112_1";colnames(sc_counts)[12] <- "X112_2";colnames(sc_counts)[13] <- "X115_0";
colnames(sc_counts)[14] <- "X115_1";colnames(sc_counts)[15] <- "X115_2";colnames(sc_counts)[16] <- "X117_0";
colnames(sc_counts)[17] <- "X117_1";colnames(sc_counts)[18] <- "X117_2";colnames(sc_counts)[19] <- "X11_1";
colnames(sc_counts)[20] <- "X11_0";colnames(sc_counts)[21] <- "X11_2";colnames(sc_counts)[22] <- "X123_0";
colnames(sc_counts)[23] <- "X123_1";colnames(sc_counts)[24] <- "X123_2";colnames(sc_counts)[25] <- "X141_0";
colnames(sc_counts)[26] <- "X141_1";colnames(sc_counts)[27] <- "X141_2";colnames(sc_counts)[28] <- "X152_1";
colnames(sc_counts)[29] <- "X152_0";colnames(sc_counts)[30] <- "X152_2";colnames(sc_counts)[31] <- "X18_1";
colnames(sc_counts)[32] <- "X18_0";colnames(sc_counts)[33] <- "X18_2";colnames(sc_counts)[34] <- "X1_0";
colnames(sc_counts)[35] <- "X1_1";colnames(sc_counts)[36] <- "X1_2";colnames(sc_counts)[37] <- "X21_1";
colnames(sc_counts)[38] <- "X21_0";colnames(sc_counts)[39] <- "X21_2";colnames(sc_counts)[40] <- "X29_1";
colnames(sc_counts)[41] <- "X29_0";colnames(sc_counts)[42] <- "X29_2";colnames(sc_counts)[43] <- "X2_0";
colnames(sc_counts)[44] <- "X2_1";colnames(sc_counts)[45] <- "X2_2";colnames(sc_counts)[46] <- "X31_1";
colnames(sc_counts)[47] <- "X31_0";colnames(sc_counts)[48] <- "X31_2";colnames(sc_counts)[49] <- "X3_0";
colnames(sc_counts)[50] <- "X3_1";colnames(sc_counts)[51] <- "X3_2";colnames(sc_counts)[52] <- "X49_0";
colnames(sc_counts)[53] <- "X49_1";colnames(sc_counts)[54] <- "X49_2";colnames(sc_counts)[55] <- "X4_1";
colnames(sc_counts)[56] <- "X4_0";colnames(sc_counts)[57] <- "X4_2";colnames(sc_counts)[58] <- "X50_1";
colnames(sc_counts)[59] <- "X50_0";colnames(sc_counts)[60] <- "X50_2";colnames(sc_counts)[61] <- "X59_0";
colnames(sc_counts)[62] <- "X59_1";colnames(sc_counts)[63] <- "X59_2";colnames(sc_counts)[64] <- "X5_1";
colnames(sc_counts)[65] <- "X5_0";colnames(sc_counts)[66] <- "X5_2";colnames(sc_counts)[67] <- "X61_1";
colnames(sc_counts)[68] <- "X61_0";colnames(sc_counts)[69] <- "X61_2";colnames(sc_counts)[70] <- "X66_0";
colnames(sc_counts)[71] <- "X66_1";colnames(sc_counts)[72] <- "X66_2";colnames(sc_counts)[73] <- "X69_1";
colnames(sc_counts)[74] <- "X69_0";colnames(sc_counts)[75] <- "X69_2";colnames(sc_counts)[76] <- "X6_0";
colnames(sc_counts)[77] <- "X6_1";colnames(sc_counts)[78] <- "X6_2";colnames(sc_counts)[79] <- "X76_0";
colnames(sc_counts)[80] <- "X76_1";colnames(sc_counts)[81] <- "X76_2";colnames(sc_counts)[82] <- "X77_1";
colnames(sc_counts)[83] <- "X77_0";colnames(sc_counts)[84] <- "X77_2";colnames(sc_counts)[85] <- "X7_1";
colnames(sc_counts)[86] <- "X7_0";colnames(sc_counts)[87] <- "X7_2";colnames(sc_counts)[88] <- "X8_0";
colnames(sc_counts)[89] <- "X8_1";colnames(sc_counts)[90] <- "X8_2";colnames(sc_counts)[91] <- "X9_0";
colnames(sc_counts)[92] <- "X9_1";colnames(sc_counts)[93] <- "X9_2";colnames(sc_counts)[94] <- "GC_Anc_1";
colnames(sc_counts)[95] <- "GC_Anc_0";colnames(sc_counts)[96] <- "GC_Anc_2";colnames(sc_counts)[97] <- "MA_Anc_1";
colnames(sc_counts)[98] <- "MA_Anc_0";colnames(sc_counts)[99] <- "MA_Anc_2";
sc_counts <- sc_counts[-c(1), ]
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,9) ]
sc_counts.a$X112_0 <-as.numeric(as.character(sc_counts.a[,2]))
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,,8,9) ]
#decided to keep length
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,8,9) ]
View(sc_counts.a)
sc_counts.z[,3:4] <- sc_counts.z[,3:4]+.5
View(sc_counts.z)
sc_counts.z <- sc_counts.a
sc_counts.z[,3:4] <- sc_counts.z[,3:4]+.5
sc_counts <- data.matrix(sc_counts)
sc_counts <- data.frame(sc_counts)
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,8,9) ]
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.split.renamchr.rmvmito.csv",header=F)
class(sc_counts)
colnames(sc_counts)[1] <- "gene"; colnames(sc_counts)[2] <- "class_code";colnames(sc_counts)[3] <- "nearest_ref_id"
colnames(sc_counts)[4] <- "ref_id"; colnames(sc_counts)[5] <- "gene_short_name"; colnames(sc_counts)[6] <- "tss_id";
colnames(sc_counts)[7] <- "locus";colnames(sc_counts)[8] <- "length";colnames(sc_counts)[9] <- "null";colnames(sc_counts)[10] <- "X112_0";
colnames(sc_counts)[11] <- "X112_1";colnames(sc_counts)[12] <- "X112_2";colnames(sc_counts)[13] <- "X115_0";
colnames(sc_counts)[14] <- "X115_1";colnames(sc_counts)[15] <- "X115_2";colnames(sc_counts)[16] <- "X117_0";
colnames(sc_counts)[17] <- "X117_1";colnames(sc_counts)[18] <- "X117_2";colnames(sc_counts)[19] <- "X11_1";
colnames(sc_counts)[20] <- "X11_0";colnames(sc_counts)[21] <- "X11_2";colnames(sc_counts)[22] <- "X123_0";
colnames(sc_counts)[23] <- "X123_1";colnames(sc_counts)[24] <- "X123_2";colnames(sc_counts)[25] <- "X141_0";
colnames(sc_counts)[26] <- "X141_1";colnames(sc_counts)[27] <- "X141_2";colnames(sc_counts)[28] <- "X152_1";
colnames(sc_counts)[29] <- "X152_0";colnames(sc_counts)[30] <- "X152_2";colnames(sc_counts)[31] <- "X18_1";
colnames(sc_counts)[32] <- "X18_0";colnames(sc_counts)[33] <- "X18_2";colnames(sc_counts)[34] <- "X1_0";
colnames(sc_counts)[35] <- "X1_1";colnames(sc_counts)[36] <- "X1_2";colnames(sc_counts)[37] <- "X21_1";
colnames(sc_counts)[38] <- "X21_0";colnames(sc_counts)[39] <- "X21_2";colnames(sc_counts)[40] <- "X29_1";
colnames(sc_counts)[41] <- "X29_0";colnames(sc_counts)[42] <- "X29_2";colnames(sc_counts)[43] <- "X2_0";
colnames(sc_counts)[44] <- "X2_1";colnames(sc_counts)[45] <- "X2_2";colnames(sc_counts)[46] <- "X31_1";
colnames(sc_counts)[47] <- "X31_0";colnames(sc_counts)[48] <- "X31_2";colnames(sc_counts)[49] <- "X3_0";
colnames(sc_counts)[50] <- "X3_1";colnames(sc_counts)[51] <- "X3_2";colnames(sc_counts)[52] <- "X49_0";
colnames(sc_counts)[53] <- "X49_1";colnames(sc_counts)[54] <- "X49_2";colnames(sc_counts)[55] <- "X4_1";
colnames(sc_counts)[56] <- "X4_0";colnames(sc_counts)[57] <- "X4_2";colnames(sc_counts)[58] <- "X50_1";
colnames(sc_counts)[59] <- "X50_0";colnames(sc_counts)[60] <- "X50_2";colnames(sc_counts)[61] <- "X59_0";
colnames(sc_counts)[62] <- "X59_1";colnames(sc_counts)[63] <- "X59_2";colnames(sc_counts)[64] <- "X5_1";
colnames(sc_counts)[65] <- "X5_0";colnames(sc_counts)[66] <- "X5_2";colnames(sc_counts)[67] <- "X61_1";
colnames(sc_counts)[68] <- "X61_0";colnames(sc_counts)[69] <- "X61_2";colnames(sc_counts)[70] <- "X66_0";
colnames(sc_counts)[71] <- "X66_1";colnames(sc_counts)[72] <- "X66_2";colnames(sc_counts)[73] <- "X69_1";
colnames(sc_counts)[74] <- "X69_0";colnames(sc_counts)[75] <- "X69_2";colnames(sc_counts)[76] <- "X6_0";
colnames(sc_counts)[77] <- "X6_1";colnames(sc_counts)[78] <- "X6_2";colnames(sc_counts)[79] <- "X76_0";
colnames(sc_counts)[80] <- "X76_1";colnames(sc_counts)[81] <- "X76_2";colnames(sc_counts)[82] <- "X77_1";
colnames(sc_counts)[83] <- "X77_0";colnames(sc_counts)[84] <- "X77_2";colnames(sc_counts)[85] <- "X7_1";
colnames(sc_counts)[86] <- "X7_0";colnames(sc_counts)[87] <- "X7_2";colnames(sc_counts)[88] <- "X8_0";
colnames(sc_counts)[89] <- "X8_1";colnames(sc_counts)[90] <- "X8_2";colnames(sc_counts)[91] <- "X9_0";
colnames(sc_counts)[92] <- "X9_1";colnames(sc_counts)[93] <- "X9_2";colnames(sc_counts)[94] <- "GC_Anc_1";
colnames(sc_counts)[95] <- "GC_Anc_0";colnames(sc_counts)[96] <- "GC_Anc_2";colnames(sc_counts)[97] <- "MA_Anc_1";
colnames(sc_counts)[98] <- "MA_Anc_0";colnames(sc_counts)[99] <- "MA_Anc_2";
sc_counts.a <- data.matrix.a(sc_counts)
sc_counts <- sc_counts[-c(1), ]
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,8,9) ]
sc_counts.a <- data.matrix.a(sc_counts)
sc_counts.a <- data.matrix(sc_counts)
sc_counts.a <- data.frame.a(sc_counts)
sc_counts.a <- data.frame(sc_counts)
sc_counts.z <- sc_counts.a
sc_counts.z[,3:4] <- sc_counts.z[,3:4]+.5
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,8,9) ]
sc_counts.a <- data.matrix(sc_counts)
sc_counts.a <- data.frame(sc_counts)
View(sc_counts.a)
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,8,9) ]
sc_counts.a <- data.matrix(sc_counts.a)
sc_counts.a <- data.frame(sc_counts.a)
library(moments)
sc_counts <- read.csv("/Users/hollymcqueary/Dropbox/McQueary/Dosage-Compensation/Redo/New_Again/genes.fpkm_table.joined.split.renamchr.rmvmito.csv",header=T)
View(sc_counts)
class(sc_counts)
str(sc_counts)
sc_counts.a <- sc_counts[,-c(1,2,3,4,6,8,9) ]
class(sc_counts.a)
str(sc_counts.a)
sc_counts.z <- sc_counts.a
sc_counts.z[,3:92] <- sc_counts.z[,4:92]+.5 #add .5 to dataset so the zeroes dont mess up
source('~/Documents/GitHub/Dosage_Compensation/Holly_DC_workflow_8.25.17.R')
warnings()
sc_counts.z[,3:92] <- sc_counts.z[,3:92]+.5 #add .5 to dataset so the zeroes dont mess up
warnings()
gene.means <- rowMeans(sc_counts.z[,3:92]) #average across the sample
anc.means <- rowMeans(sc_counts.z[,87:92]) #average in the ancestor
sc_counts.final <- sc_counts.z[-which(gene.means<5 | anc.means<5),]
sc_anc <- sc_counts.final[,c(1,2,87,88,89,90,91,92)]
sc_des <- sc_counts.final[,1:86]
index1 <- which(sc_anc[,1]==1)
index2 <- which(sc_anc[,1]==2)
index3 <- which(sc_anc[,1]==3)
index4 <- which(sc_anc[,1]==4)
index5 <- which(sc_anc[,1]==5)
index6 <- which(sc_anc[,1]==6)
index7 <- which(sc_anc[,1]==7)
index8 <- which(sc_anc[,1]==8)
index9 <- which(sc_anc[,1]==9)
index10 <- which(sc_anc[,1]==10)
index11 <- which(sc_anc[,1]==11)
index12 <- which(sc_anc[,1]==12)
index13 <- which(sc_anc[,1]==13)
index14 <- which(sc_anc[,1]==14)
index15 <- which(sc_anc[,1]==15)
index16 <- which(sc_anc[,1]==16)
ancAvg <- rowMeans(sc_anc[,3:6],na.rm=T)
ancAvg <- cbind(sc_anc[,1:2],ancAvg)
getAvgFPKM <- function(line) { #for line as "###" string
r1 <- paste(c("X",line,"_0"),collapse="") #triplicates are named X[LINE]_[rep]
r2 <- paste(c("X",line,"_1"),collapse="")
r3 <- paste(c("X",line,"_2"),collapse="")
reps <- sc_des[,c("chr","gene",r1,r2,r3)] #get those 4 columns out of the descendant dataset
reps[reps==0] <- NA #replace 0 values with NA as before
desAvg <- rowMeans(reps[,c(-1,-2)],na.rm=T)
desAvg <- cbind(sc_des[,c(1,2)],desAvg)
#colnames(desAvg) <- c("chr","gene",paste(c(line,"_Avg"),collapse=""))
return(desAvg) #returned is a matrix equivalent to ancAvg: chrm, gene, and line average FPKM
}
getFPKMRatio <- function(line) { #line must be a 3 digit character
desAvg <- getAvgFPKM(line) #first call avg fpkm script, which returns a 3 column matrix
ratioByGene <- desAvg[,3]/ancAvg[,3]
rat <- cbind(sc_des[,1:2],ratioByGene) #add gene and chrm values
colnames(rat) <- c("chrm","gene","ratio")
return(rat)
}
getChrmRatio <- function(line, chr){ #input line as "XXX", chr as a number
rat <- getFPKMRatio(line) #get list of ratios which includes chrm and gene
rat.c <- rat[(rat[,1]==chr),] #get just the rows for the appropriate chrom
rat.cs <- rat.c[order(rat.c[,3]),]#order by column 3
return(rat.cs)
}
y=NULL
rep <- c("112","115","117","11","123","141","152","18","1","21","29","2","31","3","49","4","50","59","5","61","66","69","6","76","77","7","8","9")
for(line in rep){
for(chrm in 1:16){
y <- c(y,median(getChrmRatio(line,chrm)[,3],na.rm=T))
}
}
View(sc_des)
colnames(sc_counts.a)[1] <- "gene"; colnames(sc_counts.a)[2] <- "chr"
sc_counts.z <- sc_counts.a
sc_counts.z[,3:92] <- sc_counts.z[,3:92]+.5 #add .5 to dataset so the zeroes dont mess up
warnings()
gene.means <- rowMeans(sc_counts.z[,3:92]) #average across the sample
anc.means <- rowMeans(sc_counts.z[,87:92]) #average in the ancestor
sc_counts.final <- sc_counts.z[-which(gene.means<5 | anc.means<5),]
sc_anc <- sc_counts.final[,c(1,2,87,88,89,90,91,92)]
sc_des <- sc_counts.final[,1:86]
index1 <- which(sc_anc[,1]==1)
index2 <- which(sc_anc[,1]==2)
index3 <- which(sc_anc[,1]==3)
index4 <- which(sc_anc[,1]==4)
index5 <- which(sc_anc[,1]==5)
index6 <- which(sc_anc[,1]==6)
index7 <- which(sc_anc[,1]==7)
index8 <- which(sc_anc[,1]==8)
index9 <- which(sc_anc[,1]==9)
index10 <- which(sc_anc[,1]==10)
index11 <- which(sc_anc[,1]==11)
index12 <- which(sc_anc[,1]==12)
index13 <- which(sc_anc[,1]==13)
index14 <- which(sc_anc[,1]==14)
index15 <- which(sc_anc[,1]==15)
index16 <- which(sc_anc[,1]==16)
ancAvg <- rowMeans(sc_anc[,3:6],na.rm=T)
ancAvg <- cbind(sc_anc[,1:2],ancAvg)
getAvgFPKM <- function(line) { #for line as "###" string
r1 <- paste(c("X",line,"_0"),collapse="") #triplicates are named X[LINE]_[rep]
r2 <- paste(c("X",line,"_1"),collapse="")
r3 <- paste(c("X",line,"_2"),collapse="")
reps <- sc_des[,c("chr","gene",r1,r2,r3)] #get those 4 columns out of the descendant dataset
reps[reps==0] <- NA #replace 0 values with NA as before
desAvg <- rowMeans(reps[,c(-1,-2)],na.rm=T)
desAvg <- cbind(sc_des[,c(1,2)],desAvg)
#colnames(desAvg) <- c("chr","gene",paste(c(line,"_Avg"),collapse=""))
return(desAvg) #returned is a matrix equivalent to ancAvg: chrm, gene, and line average FPKM
}
getFPKMRatio <- function(line) { #line must be a 3 digit character
desAvg <- getAvgFPKM(line) #first call avg fpkm script, which returns a 3 column matrix
ratioByGene <- desAvg[,3]/ancAvg[,3]
rat <- cbind(sc_des[,1:2],ratioByGene) #add gene and chrm values
colnames(rat) <- c("chrm","gene","ratio")
return(rat)
}
getChrmRatio <- function(line, chr){ #input line as "XXX", chr as a number
rat <- getFPKMRatio(line) #get list of ratios which includes chrm and gene
rat.c <- rat[(rat[,1]==chr),] #get just the rows for the appropriate chrom
rat.cs <- rat.c[order(rat.c[,3]),]#order by column 3
return(rat.cs)
}
y=NULL
rep <- c("112","115","117","11","123","141","152","18","1","21","29","2","31","3","49","4","50","59","5","61","66","69","6","76","77","7","8","9")
for(line in rep){
for(chrm in 1:16){
y <- c(y,median(getChrmRatio(line,chrm)[,3],na.rm=T))
}
}
ratMatMed <- matrix(y,nrow=16,ncol=28)
colnames(ratMatMed) <- rep
ratMatMed <- cbind(c(1:16),ratMatMed)
colnames(ratMatMed)[1] <- "chr"
ratMatMedRed <- ratMatMed
ratMatMedRed[ratMatMed<1.35] <- NA
View(ratMatMed)
View(ancAvg)
source('~/Documents/GitHub/Dosage_Compensation/Holly_DC_workflow_8.25.17.R')
